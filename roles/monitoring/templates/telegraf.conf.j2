[agent]
  hostname = "{{ node.name }}" # set this to a name you want to identify your node in the grafana dashboard
  flush_interval = "30s"
  interval = "30s"

[[inputs.exec]]
  commands = [
               "sudo -i -u {{ node.solana_user }} {{ node.solana_home }}/monitoring/output_starter.sh output_validator_info"
             ]
  interval = "30s"
  timeout = "30s"
  json_name_key = "measurement"
  json_time_key = "time"
  tag_keys = ["cluster_name",
              "url",
              "stake_pubkey",
              "validator_vote_key",
              "validator_name",
              "validator_ident",
              "activation_epoch"]

  json_string_fields = ["solana_version",
                        "validator_identity_pubkey",
                        "validator_vote_pubkey",
                        "cluster_environment",
                        "monitoring_version"]

  json_time_format = "unix_ms"

##OUPUTS INFLUX
[[outputs.influxdb]]
  database = "{{ monitoring.telegraf_database }}"
  urls = [ "{{ monitoring.telegraf_urls }}" ]
  username = "{{ monitoring.telegraf_username }}"
  password = "{{ monitoring.telegraf_password }}"

##OUPUTS TimeScale
[[outputs.postgresql]]
connection = "host={{ monitoring.ts_host }} user=tsdbadmin password={{ monitoring.ts_password }} sslmode=require dbname=tsdb"


